# Build Report: v0.3.0-pre / Validation & Safety Release
**Date:** 2026-01-19
**Build Status:** Release Candidate

## Executive Summary
This release focuses on **user safety and data integrity** by implementing comprehensive input validation across all calculator fields. We have introduced a smart alert system (Error/Warning/Info) that guides users without being overly restrictive, specifically addressing common dosing mistakes and physical vial limits. All core logic is now backed by a robust Python automated test suite, ensuring reliability for real user testing.

## Story Status
### Story: Input Validation & Safety
**Status:** Completed
Implemented full validation for "Water to Add", "Prescribed Dose", and "Vial Amount". Users are now prevented from entering physically impossible values (negatives, zero) and warned about potentially unsafe high doses.

### Story: Automated Testing Framework
**Status:** Completed
Establish a pytest-based testing infrastructure. Created 21 new unit tests covering all validation edge cases and 2 integration tests for application health.

## Technical Implementation
### Input Validation Logic
Implemented a 3-tier validation system in `calculator.js` and mirrored in Python:
- **Error (Red)**: Blocks invalid input or clamps to safe limits (e.g., Max Vial 30mg).
- **Warning (Orange)**: Highlights potentially dangerous inputs that require confirmation (e.g., Dose > 1000mcg).
- **Info (Yellow)**: Educates on typical ranges (e.g., Water > 10mL max capacity).

### Vial Amount Constraints
Added specific logic for peptide vials:
- **Common Range**: 5-10mg (No alert).
- **Extended Range**: 10-30mg (Info alert).
- **Hard Limit**: 30mg (Clamped).
- **Rationale**: Prevents magnitude errors (e.g., entering micrograms 5000 instead of milligrams 5) while allowing for large industrial/custom vials up to a safe reasonable limit.

## Detailed Feature Updates
<details>
<summary>Validation Rules</summary>

- **Water**: Min 1mL, Max 10mL (Clamped).
- **Dose**: Info > 500mcg, Warning > 1000mcg.
- **Vial**: Min 0.1mg, Max 30mg.
</details>

<details>
<summary>UI Improvements</summary>

- Added `inline-alert` CSS component with variants for error, warning, and info.
- Added visual error state (`input--error`) to fields with invalid data.
</details>
